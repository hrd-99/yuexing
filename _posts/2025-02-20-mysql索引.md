---
title: 'mysql索引'
date: 2025-2-20
permalink: /posts/2025/02/mysql索引/
tags:
  - mysql
excerpt: ""  # 这里设置为空，阻止预览
---
# MySQL索引

MySQL索引是帮助MySQL高效获取数据的数据结构。最常见的索引结构有两种:B+树索引和哈希索引。

## B+树索引

1. 所有数据都存储在叶子节点
2. 非叶子节点只存储键值
3. 所有叶子节点都有指向相邻叶子节点的指针
4. 查询时从根节点开始,逐层向下查找

适合范围查询和排序

## 哈希索引

1. 只能精确匹配所有索引列
2. 不支持范围查询
3. 不支持排序
4. 查询速度非常快

## 索引的优缺点

优点:
- 大大加快数据的检索速度
- 唯一索引可以保证数据的唯一性
- 可以加速表和表之间的连接

缺点:
- 创建和维护索引需要耗费时间和空间
- 更新数据时需要同时更新索引
- 索引文件会占用磁盘空间

## 使用原则

1. 最左前缀匹配原则
2. 选择区分度高的列建立索引
3. 尽量使用联合索引
4. 避免过度建立索引
5. 定期维护和优化索引

## 常见索引类型

1. 数据类型
   1. b+树
   2. hash
   3. full-text

2. 物理类型
   1. 聚簇索引
   2. 二级索引

3. 字段类型
   1. 前缀
   2. 主键
   3. 唯一
   4. 普通

4. 字段个数
   1. 单列
   2. 联合


## 索引失效的情况

1. 使用!=或<>操作符

2. 使用函数或运算符

3. 字符串不加引号 

4. like以通配符开头-%xxxx

5. or连接时某些列没有索引

   

## 减少回表

**回表（Back to Table）** 是指在使用二级索引（Secondary Index）查询时，MySQL 需要根据二级索引中的主键值回到主键索引（聚簇索引）中查找完整的数据行。

覆盖索引是指查询的所有字段都包含在二级索引中，因此不需要回表。

索引下推将过滤条件下推到存储引擎层，在存储引擎层直接过滤掉不符合条件的记录，从而减少回表次数

